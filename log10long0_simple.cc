#include <iostream>
#include <likelihood/likelihood.h>
#include <DCProgsConfig.h>
// based on the first part of fitGlyR4 removed all bursts longer than one element
// for benchmarking experiments
int main() {

  DCProgs::t_Bursts bursts{ 
      {0.000484986},
      {0.000786655466072},
      {0.000278178747976},
      {0.000406868028222},
      {8.41778601171e-05},
      {5.57252569706e-05},
      {0.000542256864719},
      {0.00010336106061},
      {0.000342724088114},
      {0.000213523075217},
      {6.15265525994e-05},
      {0.00216177862603},
      {9.46984364418e-05},
      {0.000180750575964},
      {0.000771510472987},
      {0.000247346266406},
      {0.000364423525752},
      {0.000350408343365},
      {0.000146850419696},
      {0.000229461904382},
      {0.000405209080782},
      {0.000331563642249},
      {0.000168704849784},
      {8.95963021321e-05},
      {9.44288040046e-05},
      {0.000666398031171},
      {0.000758355425205},
      {0.000152569293277},
      {0.000106846586277},
      {0.000766658224165},
      {0.0031130022835},
      {0.000866181508172},
      {0.000321542232996},
      {0.000249434524449},
      {0.00153277476784},
      {0.000188393329154},
      {0.000479891547002},
      {0.000836359453388},
      {0.000806034367997},
      {0.000212192273466},
      {0.000655774842016},
      {0.000870662624948},
      {9.14644551813e-05},
      {0.000102939338831},
      {8.73753451742e-05},
      {0.00119467021432},
      {0.000731389969587},
      {0.000720695985365},
      {7.60021066526e-05},
      {0.000389704451663},
      {0.000393112713937},
      {0.00207228789805},
      {0.000152022912516},
      {0.000174384607817},
      {9.9445322121e-05},
      {0.000293421006063},
      {9.11350507522e-05},
      {0.000508257420734},
      {0.000211675927858},
      {0.00828193221241},
      {0.00135390646756},
      {0.000241481684498},
      {0.000304228480672},
      {0.000115100505354},
      {0.00328524608631},
      {0.000140658405144},
      {5.99271297688e-05},
      {6.69251821819e-05},
      {0.000973879825324},
      {0.00141121330671},
      {0.000162356096553},
      {0.000244724855293},
      {0.000817522814032},
      {0.000287707487587},
      {0.000437993265223},
      {7.32100888854e-05},
      {0.000174130909727},
      {0.000309754017508},
      {0.00082737323828},
      {0.000155240559252},
      {0.00018826664018},
      {0.000468443060527},
      {0.00121476384811},
      {7.27031365386e-05},
      {0.000631103059277},
      {0.000101977850136},
      {0.000209722857107},
      {0.000178385875188},
      {0.000892691488843},
      {0.000322405685438},
      {5.57190905965e-05},
      {0.00053791954997},
      {0.00012199030607},
      {0.000512831611559},
      {0.000406302599004},
      {9.85971782939e-05},
      {0.000793923391029},
      {0.000150835840032},
      {0.000175495442818},
      {0.00037456426071},
      {0.00141604384407},
      {0.000141527300002},
      {0.000323695887346},
      {0.00038090304588},
      {0.00021749791631},
      {0.000527817115653},
      {7.01582684997e-05},
      {0.00026908860309},
      {0.000346381653799},
      {0.000392643327359},
      {0.000295768637443},
      {0.000144727542647},
      {0.0033023788128},
      {8.2600134192e-05},
      {0.00255447981181},
      {0.000279102066997},
      {0.000319222250255},
      {0.000340344588039},
      {0.000629996386124},
      {0.000261729670456},
      {0.000277915096376},
      {0.000551235978492},
      {0.00699514365988},
      {0.000315806042636},
      {0.000149417741341},
      {0.000243594928179},
      {0.000486631615786},
      {0.000347415130818},
      {0.000128147235955},
      {0.000104299811937},
      {0.000777013716288},
      {0.00093552574981},
      {0.000164057695656},
      {0.00184079573955},
      {0.00059309770586},
      {0.0012520654127},
      {0.000175306107849},
      {0.00029280842864},
      {0.000803351184004},
      {0.00210491544567},
      {0.000235135143157},
      {0.000358043529559},
      {0.000477680470794},
      {0.000382157886634},
      {0.00010756427946},
      {0.000128990490339},
      {0.000163310076459},
      {0.000109324231744},
      {0.00129355746321},
      {0.000267575524049},
      {0.00127542158589},
      {0.000185287557542},
      {0.00141739845276},
      {0.000490009784698},
      {0.0020391123835},
      {0.000281431013718},
      {0.000602824147791},
      {0.000135123700602},
      {0.000269380747341},
      {6.5342290327e-05},
      {0.000172183368704},
      {0.000137454422656},
      {0.000622978375759},
      {0.000273990153801},
      {0.000173575885128},
      {0.000416494644014},
      {0.000227001160965},
      {0.000408392574172},
      {0.000264000002062},
      {0.000244634778937},
      {8.32216828712e-05},
      {0.000890229537617},
      {0.000309095048578},
      {0.00190433114767},
      {0.00012018140842},
      {0.00124246848281},
      {5.2396520914e-05},
      {0.000401812867494},
      {0.000613397278357},
      {0.000329314236296},
      {0.00045306274842},
      {0.000205894364626},
      {8.56801561895e-05},
      {0.00217201886699},
      {0.000120209668239},
      {5.52745405002e-05},
      {0.000182756353752},
      {0.000185358148883},
      {0.000743115902878},
      {0.000257642532233},
      {0.000325483415509},
      {0.000126251965412},
      {0.000164412311278},
      {0.000463157390186},
      {0.000193383079022},
      {0.00106507443707},
      {6.93253823556e-05},
      {0.00428989791544},
      {7.25935751689e-05},
      {0.000343859312125},
      {0.000535933009814},
      {0.00120897078887},
      {0.000871648313478},
      {0.00142935442273},
      {7.21089891158e-05},
      {0.000177192603587},
      {0.000176852830919},
      {0.000151893211296},
      {8.71563242981e-05},
      {0.000358625489753},
      {0.000408215040807},
      {0.000661758764181},
      {0.000443024095148},
      {0.000525889743585},
      {0.000152642809553},
      {0.000211794031202},
      {0.000315754994517},
      {7.63223943068e-05},
      {0.000231662983424},
      {0.00102143583354},
      {0.000643904335448},
      {0.000129707681481},
      {0.000200411435799},
      {0.000702538411133},
      {5.98624646955e-05},
      {0.000172461775946},
      {0.00029269332299},
      {0.000206092823646},
      {0.000890056253411},
      {0.000440427364083},
      {0.000261493492872},
      {0.000395133392885},
      {0.000190915059648},
      {8.46209804877e-05},
      {0.000471015868243},
      {5.21843321621e-05},
      {7.31926338631e-05},
      {7.69006437622e-05},
      {0.000312354153721},
      {0.000104434126115},
      {6.93077163305e-05},
      {0.000242903770413},
      {0.000100239354651},
      {0.000208729688893},
      {0.000126906263176},
      {0.00074655120261},
      {0.000574616715312},
      {0.000306753499899},
      {0.000205451375223},
      {0.000575722486246},
      {0.000103380989458},
      {0.00172627647407},
      {0.000292488839477},
      {0.000448008067906},
      {0.000151543848915},
      {0.00068435590947},
      {0.000187476995052},
      {0.000165403398569},
      {0.00103371730074},
      {0.00112136786629},
      {0.000243678980041},
      {0.000225928641157},
      {0.000135573805892},
      {9.30078822421e-05},
      {0.000114734873932},
      {0.000739561219234},
      {9.0452398581e-05},
      {0.000666655716486},
      {6.61853700876e-05},
      {0.000272692210274},
      {0.000160545052495},
      {0.000305847963318},
      {0.000660597579554},
      {0.000354233226972},
      {9.26661450649e-05},
      {0.000372930604499},
      {0.000546816962014},
      {0.000372842769139},
      {0.000183624040801},
      {6.81146339048e-05},
      {0.00118638342246},
      {0.000282325054286},
      {6.5182808612e-05},
      {0.000316375982948},
      {0.000266569084488},
      {0.00381617853418},
      {0.000121509714518},
      {0.00065304042073},
      {0.000293579912977},
      {6.53493698337e-05},
      {0.000371986214304},
      {0.000301132764434},
      {0.000224204006372},
      {0.00033613393316},
      {0.00110222271178},
      {8.05759336799e-05},
      {6.92290414008e-05},
      {0.000222634582315},
      {0.000369290530216},
      {0.000386594241718},
      {8.25297975098e-05},
      {8.1246427726e-05},
      {0.000133479567012},
      {0.000434358837083},
      {0.00024638697505},
      {9.41826219787e-05},
      {0.000156118607265},
      {0.000160419731401},
      {0.000325822795276},
      {0.000185432581929},
      {0.00170034950133},
      {0.000259513122728},
      {0.000572306860704},
      {0.000373880233383},
      {0.00271447002888},
      {0.00055031827651},
      {0.000274732388789},
      {0.000116019240522},
      {0.0001123015536},
      {0.000138667703141},
      {0.000391245339415},
      {0.000355131254764},
      {0.000649030786008},
      {0.000105918268673},
      {0.000127024672111},
      {0.000204303214559},
      {8.76497288118e-05},
      {0.000668240652885},
      {0.000661854675855},
      {0.0019347773341},
      {0.000119066236948},
      {0.000477103894809},
      {0.000142514763866},
      {0.00257710303413},
      {0.000143207187648},
      {0.000166836805874},
      {0.000831399287563},
      {0.000297527585644},
      {9.53151320573e-05},
      {0.00132570369169},
      {9.87711318885e-05},
      {0.00119434797671},
      {0.000131323744426},
      {0.000152868175064},
      {0.000108647836896},
      {0.000112066183647},
      {0.000456981331808},
      {0.000521462236065},
      {0.000427427527029},
      {0.000618325604592},
      {0.00027992008836},
      {0.000202671551961},
      {5.35430626769e-05},
      {0.000234230858041},
      {9.25126441871e-05},
      {0.000181134135346},
      {0.000347561930539},
      {0.000535498576937},
      {0.0007324363105},
      {0.000318008504109},
      {0.000350436312146},
      {0.000259053515038},
      {0.00093066127738},
      {0.000979927484877},
      {0.00418955902569},
      {0.000286909227725},
      {0.000875392637681},
      {0.000154456196469},
      {9.78716780082e-05},
      {0.000130171189085},
      {0.000677996024024},
      {0.000218639412196},
      {0.000324755295878},
      {5.83415567235e-05},
      {6.69823566568e-05},
      {0.000212118669879},
      {0.00022751018696},
      {8.14039376564e-05},
      {7.55247310735e-05},
      {0.000837935367599},
      {0.0011392806191},
      {0.000385908322642},
      {0.000165865043527},
      {0.000997986877337},
      {6.15836834186e-05},
      {0.000232787802815},
      {0.000223062917939},
      {0.000307501875795},
      {0.000254618906183},
      {0.000670120702125},
      {6.93147376296e-05},
      {0.00201607798226},
      {0.000116401410196},
      {0.000120498501929},
      {0.00071426841896},
      {0.000271431053989},
      {0.000469367194455},
      {0.000273049110547},
      {0.000444127072114},
      {0.000138896139106},
      {0.00051390263252},
      {7.58932728786e-05},
      {0.000529598735739},
      {0.000372734037228},
      {0.000738611270208},
      {0.000142912263982},
      {9.90369953797e-05},
      {0.000321952742524},
      {0.000246479263296},
      {0.000165472345543},
      {0.000818177300971},
      {0.000149699146277},
      {0.000227206663112},
      {0.000275508093182},
      {0.000168336788192},
      {0.000288276118226},
      {0.00103170902003},
      {0.00102981012606},
      {0.00011007442663},
      {0.00233858008869},
      {0.000255849648966},
      {0.000298516941257},
      {0.000228250355576},
      {0.000102313788375},
      {0.00532935140654},
      {0.00019346557383},
      {0.00103889894672},
      {0.00160682113346},
      {0.00169032462873},
      {8.90939409146e-05},
      {0.000200546739507},
      {0.000136087692226},
      {9.31899849093e-05},
      {0.000481933151605},
      {0.000128195577418},
      {0.000153928631335},
      {9.93752109935e-05},
      {7.4802650488e-05},
      {0.000196432258235},
      {0.000499356945511},
      {0.000124625803437},
      {0.000107197127363},
      {0.000143427256262},
      {9.86154263956e-05},
      {0.000123601857922},
      {0.000215495660086},
      {0.00607451598626},
      {6.665015826e-05},
      {7.39668030292e-05},
      {0.000346851651557},
      {0.000318137317663},
      {0.000218422268517},
      {0.00017301972548},
      {0.000950957590248},
      {0.000540171880857},
      {0.000108042244392},
      {0.000132504152134},
      {0.000447784812422},
      {0.000495740678161},
      {0.000294286292046},
      {0.000104504157207},
      {0.000466241268441},
      {0.000203104384127},
      {6.76738345646e-05},
      {0.000602492000326},
      {0.00145485071698},
      {0.000303630280541},
      {0.000186698132893},
      {0.000105073857412},
      {0.000118579970149},
      {0.00137153547257},
      {0.000102432626591},
      {0.00129997963086},
      {0.000463621865492},
      {0.000309895403916},
      {7.10603126208e-05},
      {0.00050269102212},
      {0.0010143360123},
      {0.00100156513508},
      {0.000947230088059},
      {0.000285768473987},
      {5.95947312831e-05},
      {7.12026449037e-05},
      {0.000398128584493},
      {0.000214060084545},
      {0.000906532106455},
      {0.00446605496109},
      {0.000181621231604},
      {7.94892621343e-05},
      {0.00171148439404},
      {0.000323842454236},
      {0.00122871540952},
      {0.000164515397046},
      {0.000357225857442},
      {0.000609662907664},
      {0.000233490980463},
      {0.00147341098636},
      {7.68541358411e-05},
      {0.000767074045143},
      {0.000314931443427},
      {0.000986185041256},
      {0.000142406759551},
      {0.000315310346195},
      {8.34056481835e-05},
      {0.000868092640303},
      {0.000172037005541},
      {0.000494331703521},
      {0.00108605902642},
      {0.000291562144412},
      {0.000246543844696},
      {0.000685860053636},
      {6.0040045355e-05},
      {0.000239157496253},
      {0.000110832770588},
      {0.000102630627225},
      {0.0001450288255},
      {0.0010693387012},
      {5.40527398698e-05},
      {5.84511799389e-05},
      {0.000199213885935},
      {0.000138718882226},
      {0.000566323054954},
      {5.83925830142e-05},
      {3.90097702621e-05},
      {0.00017328505055},
      {0.000678241194692},
      {0.00118062261026},
      {0.000675882387441},
      {0.000395270180888},
      {0.000561614288017},
      {9.88725660136e-05},
      {0.000117990493891},
      {0.000144240490044},
      {0.000204410418519},
      {0.000203990377486},
      {0.00114678626414},
      {0.000546914001461},
      {0.00066157913534},
      {7.43078708183e-05},
      {0.00089166482212},
      {0.000529833952896},
      {0.000630237511359},
      {9.28901499719e-05},
      {0.00828069419367},
      {0.00127002398949},
      {0.000290063238936},
      {0.000413285451941},
      {0.00059759512078},
      {0.000856221653521},
      {0.000296686950605},
      {0.000882743217517},
      {0.000402894918807},
      {7.25529826013e-05},
      {0.000241454486968},
      {0.000522133719642},
      {0.00017974806542},
      {0.000400097575039},
      {6.57515920466e-05},
      {8.65048859851e-05},
      {0.000348495028447},
      {0.000263001478743},
      {0.00120329970377},
      {0.00184388877824},
      {0.00202279607765},
      {0.000332189723849},
      {0.00143640243914},
      {0.000274662976153},
      {6.94780319463e-05},
      {0.00229238392785},
      {0.000260561297182},
      {0.000313040072797},
      {0.00101579236798},
      {0.00337585766101},
      {0.000599147286266},
      {0.000307932670694},
      {0.000100837896753},
      {0.000897434772924},
      {0.000422686571255},
      {0.00109651501407},
      {0.000326451088767},
      {0.000656802440062},
      {0.0001160965694},
      {0.00053157156799},
      {9.97266979539e-05},
      {8.42265653773e-05},
      {0.000279530417174},
      {0.00195094401715},
      {0.000815906896605},
      {0.000836279825307},
      {0.000459110626252},
      {0.000293738063192},
      {0.000394779926864},
      {0.0021631042473},
      {6.79917066009e-05},
      {0.000107767344161},
      {0.000485329379444},
      {0.000317745987559},
      {0.000230366829783},
      {0.000120479497127},
      {0.000220372457989},
      {0.0010743092862},
      {0.000111591194582},
      {0.000419146410422},
      {0.00010009327525},
      {9.87783278106e-05},
      {0.000240132838371},
      {0.000520798144862},
      {0.000156670052093},
      {0.00138911487011},
      {0.000123933597934},
      {0.000614799442701},
      {0.000228318371228},
      {0.000300459767459},
      {0.000391856359784},
      {0.000173935812199},
      {0.000588779861573},
      {0.000241456800723},
      {0.000182645526365},
      {6.96240313118e-05},
      {0.000123024670756},
      {0.000979563337751},
      {0.000477823778056},
      {0.000799302069936},
      {0.00109268270899},
      {0.000203995135962},
      {0.000132240500534},
      {0.000214552259422},
      {0.000197936285986},
      {0.000234996856307},
      {0.000265519687673},
      {0.000347613560734},
      {0.000819036213215},
      {0.00131165247876},
      {0.000862637127284},
      {0.000957539246883},
      {0.000102899546619},
      {0.000198280162294},
      {0.000775062711909},
      {0.000168760758243},
      {0.000111321343866},
      {0.000267759838607},
      {0.000773854844738},
      {0.00121197814588},
      {0.000115198250569},
      {0.00229178290465},
      {0.0007587360451},
      {0.000558455241844},
      {0.00108822644688},
      {0.000189380385564},
      {9.03520631255e-05},
      {0.000622682913672},
      {0.000191896368051},
      {0.000169944294612},
      {0.00436389818788},
      {0.0018865307793},
      {9.3491464213e-05},
      {0.000186441291589},
      {0.000260573142441},
      {0.000286033522571},
      {0.000122261844808},
      {6.45620166324e-05},
      {6.05916829954e-05},
      {0.000424884317908},
      {0.000346787681337},
      {0.00176778115565},
      {0.000141736833029},
      {0.000257891748333},
      {0.00029700002051},
      {0.000499731104355},
      {0.000984137644991},
      {0.000201527000172},
      {8.61561929923e-05},
      {7.52009364078e-05},
      {7.15439527994e-05},
      {0.000351784925442},
      {6.34943862678e-05},
      {0.000615931174252},
      {0.000232401143876},
      {0.00245955219725},
      {0.000458507944131},
      {0.00295717013068},
      {0.000357939985406},
      {0.000239035915001},
      {0.000815768144093},
      {6.4065308834e-05},
  };

  DCProgs::Log10Likelihood likelihood( bursts, /*nopen=*/3, /*tau=*/3e-5, /*tcrit=*/3e-3, /*nmax*/2, 1e-12, 1e-12, 100, -1e6, 0);

  // std::cout << likelihood << std::endl;

  DCProgs::t_rmatrix matrix(10 ,10);
  matrix << -4500., 0., 0., 4500., 0., 0., 0., 0., 0., 0.,
             0., -2500., 0., 0., 2500., 0., 0., 0., 0., 0.,
             0., 0., -900., 0., 0., 900., 0., 0., 0., 0.,
             700., 0., 0., -17200., 8000., 0., 0., 0., 8500., 0.,
             0., 1800., 0., 5000., -12650., 4000., 0., 1850., 0., 0.,
             0., 0., 18000.,0., 7500., -25700., 200., 0.,0.,0.,
             0., 0., 0., 0., 0., 67459.45945946, -73309.45945946, 5850., 0., 0.,
             0., 0., 0., 0., 10000., 0., 50., -13950., 3900., 0.,
             0., 0., 0., 736.31323631, 0., 0., 0., 100., -2786.31323631, 1950.,
             0., 0., 0., 0., 0., 0., 0., 0., 150., -150.;
  DCProgs::t_real result;
  for(int i=0;i<1000;i++) {
      result = likelihood(matrix);
  }
  //std::cout << "Transition Rate matrix:\n" << DCProgs::numpy_io(matrix) << "\n";
  std::cout << "Computation: " << result << std::endl;
  
  return 0;
}
